@namespace SharedComponents
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@inject ProtectedSessionStorage ProtectedSessionStore


<div class="main">
    <div class="top-row px-4" style="float:right">
        @if (account is null) {
            <NavLink class="nav-link" href="login" Match="NavLinkMatch.All">
                <span class="oi oi-home" aria-hidden="true"></span> Login
            </NavLink>
        }
        else {
            <NavLink class="nav-link" href="myaccount" Match="NavLinkMatch.All">
                <span class="oi oi-home" aria-hidden="true"></span> Welcome, @account.Name
            </NavLink>
        }

    </div>
</div>


@code{
    private UserAccount account;
    protected override async Task OnInitializedAsync() {
        var result = await ProtectedSessionStore.GetAsync<UserAccount>("account");
        if (result.Value is not null) {
            account = result.Value;
        }
    }

    public async Task<bool> GetAccount() {
        var result = await ProtectedSessionStore.GetAsync<UserAccount>("account");
        if (result.Value is not null) {
            account = result.Value;
            return true;
        }
        return false;
    }
}
